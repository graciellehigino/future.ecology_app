---
title: "Designing a collective prototype of future tropical and subtropical science"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(message = FALSE, warning = FALSE)
library(flexdashboard)
library(knitr)
library(kableExtra)
library(palettetown)
library(patchwork)
source("dashboard/DataPrep.R")
```

Dinosaurs
=====================================  

Column {data-width=70%}
-------------------------------------

### Where have the dinosaurs been?

```{r}

ggplot() +
  geom_sf(data = world,
          aes(geometry = geom),
          colour = NA) +
  geom_sf(data = locations,
          aes(geometry = geom),
          fill = "pink",
          alpha = 0.9,
          colour = NA) +
  theme_void() + 
  inset_element(png::readPNG("images/Coelophysis.png", native = TRUE), #Coelophysis
                left = 0.0,
                bottom = 0.0,
                right = 0.1,
                top = 0.30, 
                align_to = 'full') + theme_void() +
  inset_element(png::readPNG("images/Trex.png", native = TRUE), #TRex
                left = 0.0,
                bottom = 0.6,
                right = 0.2,
                top = 0.8, 
                align_to = 'full') + theme_void() +
  inset_element(png::readPNG("images/Velociraptor.png", native = TRUE), #Veloci
                left = 0.7,
                bottom = 0.7,
                right = 0.9,
                top = 0.9, 
                align_to = 'full') + theme_void() +
  inset_element(png::readPNG("images/Parasaur.png", native = TRUE), #Parasaur
                left = 0.4,
                bottom = 0.05,
                right = 0.6,
                top = 0.25, 
                align_to = 'full') + theme_void() +
  inset_element(png::readPNG("images/Coelophysis.png", native = TRUE), #Bronto
                left = 0.0,
                bottom = 0.21,
                right = 0.07,
                top = 0.30, 
                align_to = 'full') + theme_void() +
  inset_element(png::readPNG("images/Coelophysis.png", native = TRUE), #Meg
                left = 0.0,
                bottom = 0.21,
                right = 0.07,
                top = 0.30, 
                align_to = 'full') + theme_void() +
  inset_element(png::readPNG("images/Coelophysis.png", native = TRUE), #pterdoactyl
                left = 0.0,
                bottom = 0.21,
                right = 0.07,
                top = 0.30, 
                align_to = 'full') + theme_void() +
  inset_element(png::readPNG("images/Coelophysis.png", native = TRUE), #pterosaurus
                left = 0.0,
                bottom = 0.21,
                right = 0.07,
                top = 0.30, 
                align_to = 'full') + theme_void() +
  inset_element(png::readPNG("images/Coelophysis.png", native = TRUE), #tricera
                left = 0.0,
                bottom = 0.21,
                right = 0.07,
                top = 0.30, 
                align_to = 'full') + theme_void() +
  inset_element(png::readPNG("images/Coelophysis.png", native = TRUE), #archi
                left = 0.0,
                bottom = 0.21,
                right = 0.07,
                top = 0.30, 
                align_to = 'full') + theme_void()

```

Column {data-width=30%}
-------------------------------------

```{r  out.width = "100%"}
include_graphics('images/future_scientist.jpg') 
```

### Career Stage

```{r}

survey %>%
  filter(`Translated to` == "EN") %>%
  count(`What is your career stage?`) %>%
  na.omit() %>%
  summarise(percentage = n/sum(n)*100,
            stage = `What is your career stage?`) %>%
  ggplot() +
  geom_col(aes(x = 2,
               y = percentage,
               fill = stage)) +
  xlim(c(0.7, 2.5)) +
  ylim(c(0, 100)) +
  coord_polar(theta = 'y') +
  scale_fill_poke(guide = guide_legend(title = "Career stage"),
                  pokemon = 134, spread = 6) +
  theme_void()

```

### At home?

```{r}
survey %>%
  filter(`Translated to` == "EN") %>%
  count(`Are you studying in your home country?`) %>%
  na.omit() %>%
  summarise(percentage = n/sum(n)*100,
            home = `Are you studying in your home country?`) %>%
  ggplot() +
  geom_col(aes(x = 2,
               y = percentage,
               fill = home)) +
  xlim(c(0.7, 2.5)) +
  ylim(c(0, 100)) +
  coord_polar(theta = 'y') +
  scale_fill_poke(guide = guide_legend(title = "Studying at home?"),
                  pokemon = 13, spread = 2) +
  theme_void()
```


Past
=====================================  

Column {data-width=600}
-------------------------------------

### Sentiment

```{r}
comparison.cloud(question_4,
                 colors = sent_pal,
                 max.words = 100, scale=c(3.5,0.50))
```

Column {data-width=400}
-------------------------------------

```{r  out.width = "100%"}
include_graphics('images/future_scientist.jpg') 
```

### Full Responses

Note some answers have been translated from their original language or altered by the request of the correspondent

```{r}

survey %>%
  filter(`Translated to` == "EN") %>%
  select(`Tell us a short story about your background in science! Do you want to share an image or a video that represents your story as a tropical/subtropical ecologist? Go ahead!`) %>%
  na.omit() %>%
  kable(align = "c")%>%
  kable_styling(bootstrap_options = c("striped", "condensed","responsive", "bordered")) %>%
  row_spec(0, background = "pink", align = "c", bold = TRUE) #%>%
#scroll_box(width = "500px", height = "400px") 

```

Present
=====================================     

Column {data-width=600}
-------------------------------------

### Sentiment

```{r}
comparison.cloud(question_5,
                 colors = sent_pal,
                 max.words = 100, scale=c(3.5,0.50))
```

Column {data-width=400}
-------------------------------------

```{r  out.width = "100%"}
include_graphics('images/future_scientist.jpg') 
```

### Full Responses

Note some answers have been translated from their original language or altered by the request of the correspondent

```{r}

survey %>%
  filter(`Translated to` == "EN") %>%
  select(`What advice would you give your past-self or a young researcher from your country?`)  %>%
  na.omit() %>%
  kable(align = "c") %>%
  kable_styling(bootstrap_options = c("striped", "condensed","responsive", "bordered")) %>%
  row_spec(0, background = "pink", align = "c", bold = TRUE) #%>%
#scroll_box(width = "500px", height = "400px") 

```

Future
=====================================  

Column {.tabset}
-------------------------------------

### Sentiment

```{r}
comparison.cloud(question_6,
                 colors = sent_pal,
                 max.words = 100, scale=c(3.5,0.50))
```

### Sentiment - remixed

```{r}



```

Column {data-width=400}
-------------------------------------

```{r  out.width = "100%"}
include_graphics('images/future_scientist.jpg') 
```

### Full Responses

Note some answers have been translated from their original language or altered by the request of the correspondent

```{r}

survey %>%
  filter(`Translated to` == "EN") %>%
  select(`Describe your dream of the future as a tropical scientist in a tweet (up to 280 characters).`)  %>%
  na.omit() %>%
  kable(align = "c")%>%
  kable_styling(bootstrap_options = c("striped", "condensed","responsive", "bordered")) %>%
  row_spec(0, background = "pink", align = "c", bold = TRUE) #%>%
#scroll_box(width = "500px", height = "400px") 

``` 